<!DOCTYPE html>
<html lang="pl">
    <head>
        <meta charset="UTF-8">
        <title>Skracacz URL</title>  <!-- Tytul strony w zakladce -->
        <style>
            body { /* Cala strona */
                font-family: Arial, sans-serif;
                margin: 20px;
                background-color: white;
            }

            h1 { /* Naglowki */
                font-size: 24px;
            }

            p { /* Paragrafy */
                color: #666;
            }

            input[type="text"] { /* Pola tekstowe */
                width: 500px;
                padding: 8px;
                font-size: 14px;
                border: 1px solid #000;
            }

            button { 
                padding: 8px 16px;
                font-size: 14px;
                background-color: #ddd;
                border: 1px solid #000;
                cursor: pointer;
            }

            table { 
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
            }

            th, td { /* Naglowki i komorki tabeli */
                border: 1px solid #000;
                padding: 8px;
                text-align: left;
            }

            th {
                background-color: #ddd;
            }

            .delete-btn {
                padding: 4px 8px;
                font-size: 12px;
                background-color: #ddd;
                border: 1px solid #000;
                cursor: pointer;
            }
        </style>
    </head>
    <body>
        <h1>Skracacz URL</h1>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                {% if category == "error" %}
                    <div class="alert alert-error">
                    {{ message }}
                    </div>
                {% endif %}
                {% endfor %}
            {% endif %}
        {% endwith %}

        <p>Wklej adres URL:</p>

        <form action="/shorten" method="post">
            <input type="text" name="url" placeholder="https://example.com/..." required>
            <button type="submit">Skróć</button>
        </form>

        <hr>

        <h2>Lista URLi</h2>

        {% if urls %}
            <table>
                <tr>
                    <th>Kod</th>
                    <th>Skrócony URL</th>
                    <th>Oryginalny URL</th>
                    <th>Data</th>
                    <th>Usuwanie</th>
                </tr>
                {% for url in urls %}
                    <tr>
                        <td>{{ url.short_code }}</td> <!-- Kod -->
                        <td> <!-- Skrocony url -->
                            <a href="http://127.0.0.1:5000/{{ url.short_code }}">
                                http://127.0.0.1:5000/{{ url.short_code }}
                            </a>
                        </td>
                        <td> <!-- Oryginalny url -->
                            <a href="{{ url.original_url }}">
                                {{ url.original_url[:80] }}{% if url.original_url|length > 80 %}...{% endif %}
                            </a>
                        </td>
                        <td>{{ url.created_at.strftime('%Y-%m-%d %H:%M') }}</td> <!-- Data -->
                        <td> <!-- Usuwanie -->
                            <form action="/delete/{{ url.id }}" method="post" style="margin: 0;">
                                <button type="submit" class="delete-btn">Usuń</button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <p>Brak URLi w bazie.</p>
        {% endif %}

    </body>
</html>